# Добавление новых форматов выписки

**Sberbank2Excel** имеет модульную конструкцию, где для каждого типа выписки имеется отдельный модуль.

Таким образом для того чтобы добавить поддержку нового формата выписки необходимо создать и зарегистрировать новый модуль экстрактора.

## Создать новый модуль типа extractor_XXXX.py

Модуль типа `extractor_XXXX.py` должен содержать класс, который наследует от абстрактного класса [`Extractor`](core/extractor.py) и должен содержать имплементацию всех абстрактных методов этого класса.

Проще всего скопировать один из существующих экстракторов (например [`extractor_SBER_CREDIT_2110.py`](core/extractor_SBER_CREDIT_2110.py) и изменить код так, чтобы он соответствовал бы новому типу выписки.

Все модули экстракторов содержат также код для самотестирования в части модуля `if __name__ == '__main__':`

Шаги по создания нового модуля экстрактора:

**Шаг 1.** Скопировать [`extractor_SBER_CREDIT_2110.py`](core/extractor_SBER_CREDIT_2110.py) под новым именем.

**Шаг 2.** Переименовать `class SBER_CREDIT_2107(Extractor)` (к примеру `class SOME_NEW_FORMAT(Extractor)`)

**Шаг 3.** Внести новое имя класса в строку, которая запускает автотестирование

```py
extractors_generic.debug_extractor(SBER_CREDIT_2107, test_text_file_name=sys.argv[1])
```

**Шаг 4.** Переписать все методы класса `SOME_NEW_FORMAT`. Методы можно переписывать по одному, последовательно проверяя их запуская модуль из командной строки, указывая на файл текстового варианты выписки в качестве аргумента (промежуточный текстовый вариант выписку будет создан автоматически при попытке сконвертировать неизвестный формат).

``` py extractor_XXXXXX.py bank_extract_converted_to_txt.txt ```

Это будет запускать функцию `extractors_generic.debug_extractor`. В конечном итоге функция должна отрабатывать без ошибок.

## Зарегистрировать модуль экстрактора
После того как новый модуль экстрактора полностью протестирован изолированно его надо зарегистрировать в модуле [`extractors.py`](core/extractors.py) используя в качестве образца уже зарегистрированные экстракторы

Теперь можно приступать к тестированию конвертируя выписку обычным способом.
